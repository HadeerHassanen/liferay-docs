<h1>4</h1>
<hr/><h1>Generic Faces Portlet</h1><p>The portlet bridge isn&rsquo;t a portlet. It is a distinct subsystem a portlet acquires, instantiates, and executes when it needs to handle requests that target Faces artifacts. Though the bridge has a simple API and relies on familiar lifecycles and mechanisms, many portlets will find it more convenient to subclass an object that manages the details of the bridge&rsquo;s execution than to manage the bridge directly. The <code>GenericFacesPortlet</code> is provided for this purpose. Though a client of the bridge, <code>GenrericFacesPortlet</code> is included as part of the specification to provide an out-of-the-box solution for portlet developers as well as to provide portlet developers a better appreciation of how and how much work is involved in using the bridge.</p><a id="a-name41"></a><h2><a name="4.1"></a>4.1 Configuration</h2><p>To provide flexibility, the <code>GenericFacesPortlet</code> recognizes the following application initialization parameters:</p>
<pre><code>javax.portlet.faces.BridgeClassName 
</code></pre><p><code>BridgeClassName</code> specifies the name of the bridge class the <code>GenericFacesPortlet</code> uses to instantiate bridge instances for all portlets in this web application. If not specified, the <code>GenericFacesPortlet</code> defaults to finding the class name by looking for the context resource (file) called &ldquo;<code>META-INF/services/javax.portlet.faces.Bridge</code>&rdquo; and reading the first line (excluding preceding and succeeding white space).</p><p>Because bridge implementations are expected to include such a context resource file in their jar file, portlet applications relying on the <code>GenericFacesPortlet</code> typically do not set this initialization parameter. It is provided for those environments where multiple such resource files exist (because there are multiple bridge implementations in the environment) and resource resolution doesn&rsquo;t yield the desired class name.</p><p>In addition the <code>GenericFacesPortlet</code> reads the following portlet initialization parameters and either sets the appropriate context attributes<sup>[<a href="TCK-Tests.html#4.1">4.1</a>]</sup> to direct the bridge&rsquo;s execution or uses it to impact its own behavior:</p>
<pre><code>javax.portlet.faces.defaultViewId.[mode]
javax.portlet.faces.excludedRequestAttributes
javax.portlet.faces.preserveActionParams
javax.portlet.faces.bridgeEventHandler
javax.portlet.faces.bridgePublicRenderParameterHandler
javax.portlet.faces.autoDispatchEvents
javax.portlet.faces.defaultRenderKitId
</code></pre><p><code>javax.portlet.faces.defaultViewId.[mode]</code> specifies the name of the <code>defaultViewId</code> used for a named portlet <code>PortletMode</code>. Note: <em>mode</em> is the <code>String</code> form of portlet <code>PortletMode</code>.</p><p><code>javax.portlet.faces.excludedRequestAttributes</code> is a comma delimited list of attribute names the bridge is to exclude from managing in the bridge request scope. The values in this list will either identify a specific attribute name to exclude or a set of attributes. The later is identified by a String value with the wildcarded suffix &ldquo;.<em>&ldquo;. Such wildcard usage indicates the bridge is to exclude all those attributes within the namespace identified by removing the &rdquo;</em>&rdquo;, non-recursive.</p><p><code>javax.portlet.faces.preserveActionParams</code> is a boolean valued String that when true indicates the bridge must maintain the action&rsquo;s request parameters for the duration of the bridge request scope <a href="Chapter-5-Bridge-Lifecycle-Requirements.html#5.1.2">5.1.2</a>. When this initialization parameter isn&rsquo;t present or is <code>false</code> the action&rsquo;s request parameters are only maintained for the duration of the portlet request scope. The exception to this is the <code>ResponseStateManager.VIEW_STATE_PARAM</code> parameter which is always maintained in the bridge request scope regardless of this setting.</p><p><code>javax.portlet.faces.bridgeEventHandler</code> is a <code>String</code> naming the class that implements the <code>javax.portlet.faces.BridgeEventHandler</code> interface that the bridge uses to process events. See section <a href="Chapter-5-Bridge-Lifecycle-Requirements.html#5.2.5">5.2.5</a> for detail concerning event support.</p><p><code>javax.portlet.faces.bridgeRenderParameterHandler</code> is a <code>String</code> naming the class that implements the <code>javax.portlet.faces.BridgePublicRenderParameterHandler</code> interface that the bridge calls after pushing mapped public render parameters into beans. This handler gives the portlet an opportunity to recompute and get into a new consistent state after such changes. See section <a href="Chapter-5-Bridge-Lifecycle-Requirements.html#5.3">5.3</a> for detail concerning public render parameter support.</p><p><code>javax.portlet.faces.autoDisptachEvents</code> is a boolean valued <code>String</code> defining whether the bridge overrides regular portlet event processing dispatching all events to the bridge. If <code>true</code> the <code>GenericFacesPortlet</code> overrides processEvent() and dispatches all events to the bridge. If <code>false</code> the <code>GenericFacesPortlet</code> delegates all event processing to the standard portlet model. Use <code>true</code> if the portlet is written entirely in JSF. Use <code>false</code>, if your portlet uses a mixture of view technologies. In the later case, the portlet is responsible for recognizing the events which should be handled in JSF and dispatch them directly to the bridge. The default value is <code>true</code>. See section <a href="Chapter-5-Bridge-Lifecycle-Requirements.html#5.2.5">5.2.5</a> for detail concerning handling events.</p><p><code>javax.portlet.faces.defaultRenderKitId</code> is a <code>String</code> defining this portlet&rsquo;s default renderkit Id. Providing a value will cause the <code>GenericFacesPortlet</code> to configure the bridge to use this specific default renderkit Id for the portlet rather than application level default (set in the <code>faces-config.xml</code>).</p><p>There are two portlet initialization parameters that were recognized by the portlet 1.0 bridge that are no longer recognized and used in the portlet 2.0 bridge:</p>
<pre><code>javax.portlet.faces.defaultContentType
javax.portlet.faces.defaultCharacterSetEncoding
</code></pre><p>These parameters were used by the GenericFacesPortlet to preset the response content type before delegating to the bridge to handle the request. Because the portlet 2.0 bridge now uses dispatch.forward() to render Faces views that are jsps, this presetting is no longer needed. The requirement to recognize these init parameters no longer exists and their presence is ignored.</p><a id="a-name42"></a><h2><a name="4.2"></a>4.2 Structure</h2><p>The <code>GenericFacesPortlet</code> subclasses <code>javax.portlet.GenericPortlet</code>. It overrides the <code>init</code>, <code>destroy</code>, <code>doDispatch</code>, <code>doEdit</code>, <code>doHelp</code>, <code>doView</code>, and <code>processAction</code> methods. In addition it defines the following new methods:</p>
<pre><code>getBridgeClassName
getDefaultViewIdMap
getExcludedRequestAttributes
isPreserveActionParameters
getResponseContentType
getResponseCharacterSetEncoding
getBridgeEventHandler
getBridgePublicRenderParameterHandler
isAutoDispatchEvents
getFacesBridge
</code></pre><p><code>getBridgeClassName()</code> allows a subclass to override the GenericFacesPortlet mechanism for determining which bridge class to instantiate <a href="Chapter-4-GenericFacesPortlet.html#4.2.6">4.2.6</a>.</p><p><code>getDefaultViewIdMap()</code> allows a subclass to override the <code>GenericFacesPortlet</code> mechanism for determining the <code>Map</code> of the default <code>viewId</code> that should be used in each <code>PortletMode</code> when the request doesn&rsquo;t otherwise indicate a specific view <a href="Chapter-4-GenericFacesPortlet.html#4.2.7">4.2.7</a>. This <code>Map</code> contains one entry per <code>PortletMode</code>. The entry key is the name of the <code>PortletMode</code>. The entry value is the mode&rsquo;s default <code>viewId</code>.</p><p><code>getExcludedRequestAttributes()</code> allows a subclass to override the <code>GenericFacesPortlet</code> mechanism for determining the set of request attributes to exclude from the bridge request scope <a href="Chapter-4-GenericFacesPortlet.html#4.2.8">4.2.8</a>.</p><p><code>getPreserveActionParameters()</code> allows a subclass to override the <code>GenericFacesPortlet</code> mechanism for determining whether the bridge needs to preserve action parameters for subsequent renders <a href="Chapter-4-GenericFacesPortlet.html#4.2.9">4.2.9</a>.</p><p><code>getResponseContentType()</code> is deprecated as it is no longer called by the <code>GenericFacesPortlet</code>. It exists merely for backwards compatibility in the off chance that a subclass called it.</p><p><code>getResponseCharacterSetEncoding()</code> is deprecated as it is no longer called by the <code>GenericFacesPortlet</code>. It exists merely for backwards compatibility in the off chance that a subclass called.</p><p><code>getBridgeEventHandler()</code> allows a subclass to override the <code>GenericFacesPortlet</code> mechanism for determining the <code>BridgeEventHandler</code> the bridge should use to process events <a href="Chapter-4-GenericFacesPortlet.html#4.2.12">4.2.12</a>.</p><p><code>getBridgePublicRenderParameterHandler()</code> allows a subclass to override the <code>GenericFacesPortlet</code> mechanism for determining the <code>BridgePublicRenderParameterHandler</code> the bridge should use to post process incoming public render parameters <a href="Chapter-4-GenericFacesPortlet.html#4.2.13">4.2.13</a>.</p><p><code>isAutoDispatchEvents()</code> allows a subclass to override the <code>GenericFacesPortlet</code> mechanism for determining the setting for the <code>autoDispatchEvents boolean</code> <a href="Chapter-4-GenericFacesPortlet.html#4.2.14">4.2.14</a>.</p><p><code>getFacesBridge()</code> primarily used by a subclass to get the <code>GenericFacesPortlet</code>&rsquo;s bridge in situations where the subclass needs to directly call its <code>doFacesRequest</code> method. <a href="Chapter-4-GenericFacesPortlet.html#4.2.15">4.2.15</a>.</p><p><code>getDefaultRenderKitId()</code> allows a subclass to override the <code>GenericFacesPortlet</code> mechanism for determining the renderkit Id (if any) the bridge conveys to Faces for use as the default renderkit Id when acquiring a <code>RenderKit</code> and rendering <a href="Chapter-4-GenericFacesPortlet.html#4.2.16">4.2.16</a>.</p><a id="a-name421"></a><h3><a name="4.2.1"></a>4.2.1 init():</h3><p>The <code>GenericFacesPortlet</code> overrides the <code>init</code> method and does the following<sup>[<a href="TCK-Tests.html#4.2">4.2</a>]</sup>:</p>
<ul>
  <li><p>it determines the specific <code>Bridge</code> implementation class to use for this portlet by calling <code>getBridgeClassName()</code>.</p></li>
  <li><p>it calls <code>getExcludedRequestAttributes()</code>. The result of this call is set as a <code>PortletContext</code> attribute as per this specification <a href="TCK-Tests.html#3.2">3.2</a>.</p></li>
  <li><p>it calls <code>isPreserveActionParameters()</code>. The result of this call is set as a <code>PortletContext</code> attribute as per this specification <a href="TCK-Tests.html#3.2">3.2</a>.</p></li>
  <li><p>it calls <code>getDefaultViewIdMap()</code>. The result of this call is set as a <code>PortletContext</code> attribute as per this specification <a href="TCK-Tests.html#3.2">3.2</a>.</p></li>
  <li><p>it calls <code>getBridgeEventHandler()</code>. The result of this call, if not null, is set as a <code>PortletContext</code> attribute as per this specification <a href="TCK-Tests.html#3.2">3.2</a>.</p></li>
  <li><p>it calls <code>getBridgePublicRenderParameterHandler()</code>. The result of this call, if not <code>null</code>, is set as a <code>PortletContext</code> attribute as per this specification <a href="TCK-Tests.html#3.2">3.2</a>.</p></li>
  <li><p>it calls <code>getDefaultRenderKitId()</code>. The result of this call, if not null, is set as a <code>PortletContext</code> attribute as per this specification <a href="TCK-Tests.html#3.2">3.2</a>.</p></li>
</ul><p>Note: instantiating and initializing the bridge may be deferred until it needs to dispatch the first request.</p><a id="a-name422"></a><h3><a name="4.2.2"></a>4.2.2 destroy():</h3><p>The <code>GenericFacesPortlet</code> overrides the <code>destroy</code> method and does the following<sup>[<a href="TCK-Tests.html#NT">NT</a>]</sup>:</p>
<ul>
  <li><p>if it has activated a bridge, it calls the bridge&rsquo;s <code>destroy()</code> method.</p></li>
  <li><p>it resets its internal data members to an uninitialized state.</p></li>
</ul><a id="a-name423"></a><h3><a name="4.2.3"></a>4.2.3 doDispatch():</h3><p>The <code>GenericFacesPortlet</code> overrides the <code>doDispatch</code> method and does the following<sup>[<a href="TCK-Tests.html#NT">NT</a>]</sup>:</p>
<ul>
  <li><p>if the requested portlet <code>Mode</code> is <code>View</code>, <code>Help</code>, or <code>Edit</code>, it delegates to its superclass without doing any work.</p></li>
  <li><p>otherwise, for non-standard <code>Modes</code>, it processes the request as described in <a href="Chapter-4-GenericFacesPortlet.html#4.2.5">section 4.2.5</a>.</p></li>
</ul><a id="a-name424"></a><h3><a name="4.2.4"></a>4.2.4 doView(), doEdit(), doHelp(), processAction(), serveResource(), processEvent():</h3><p>The <code>GenericFacesPortlet</code> overrides the <code>doView()</code>, <code>doEdit()</code>, <code>doHelp()</code>, <code>processAction()</code>, and <code>serveResource()</code> methods and executes the request via the bridge. I.e. portlets that want to override this behavior to detect nonFaces targets should either provide this logic in <code>doDispatch()</code> or in a subclassed method of the above.</p><p>The <code>GenericFacesPortlet</code> overrides the <code>processEvents()</code> method and if <code>isAutoDispatchEvents()</code> returns <code>true</code> executes this request via the bridge otherwise it delegates the handling of this event to its superclass. I.e. where the subclassing portlet has first shot at overriding the above methods, in the case of events, the <code>GenericFacesPortlet</code> typically has the first shot (assuming the portlet is using the preferred method of annotating event methods).</p><a id="a-name425"></a><h3><a name="4.2.5"></a>4.2.5 Request Processing</h3><p>When not overridden by a subclass, the <code>GenericFacesPortlet</code> processes the request by first determining if the target of the request is a Faces or a nonFaces view. A nonFaces view target is recognized if the request contains the parameter <code>_jsfBridgeNonFacesView</code>. The value of this parameter is the <code>ContextPath</code> relative path to the nonFaces target. To handle this request the <code>GenericFacesPortlet</code> sets the response contentType, if not already set, using the preferred contentType expressed by the portlet container. It then uses a portlet <code>RequestDispatcher</code> to dispatch(include) the nonFaces target<sup>[<a href="TCK-Tests.html#4.3">4.3</a>]</sup>.</p><p>All other requests are assumed by the <code>GenericFacesPortlet</code> to be Faces requests and are executed by calling the bridge. To facilitate navigations from nonFaces views to Faces views, the <code>GenericFacesPortlet</code> recognizes the request parameters <code>_jsfBridgeViewId</code> and <code>_jsfBridgeViewPath</code>. Prior to executing the bridge, the <code>GenericFacesPortlet</code> must check for both the <code>_jsfBridgeViewId</code> request parameter and the <code>_jsfBridgeViewPath</code> request parameter. If either the <code>_jsfBridgeViewId</code> parameter exists or both parameters exist and the <code>_jsfBridgeViewId</code> parameter value is non null, the <code>GenericFacesPortlet</code> must set the value of the request attribute <code>javax.portlet.faces.viewId</code> to the value of the <code>_jsfBridgeViewId</code> parameter<sup>[<a href="TCK-Tests.html#4.4">4.4</a>]</sup>. If only the <code>_jsfBridgeViewPath</code> parameter exists and contains a non null value, the <code>GenericFacesPortlet</code> must set the value of the request attribute <code>javax.portlet.faces.viewPath</code> to the value of the <code>_jsfBridgeViewPath</code> parameter<sup>[<a href="TCK-Tests.html#4.5">4.5</a>]</sup>. Otherwise the bridge is called without either of these attributes being set<sup>[<a href="TCK-Tests.html#4.6">4.6</a>]</sup>.</p><a id="a-name426"></a><h3><a name="4.2.6"></a>4.2.6 getBridgeClassName()</h3><p>The bridge calls this method during <code>init()</code>. <code>getBridgeClassName</code> returns the name of the class the <code>GenericFacesPortlet</code> uses to instantiate the bridge. The default (<code>GenericFacesPortlet</code>) implementation returns the value of the <code>javax.portlet.faces.BridgeClassName</code> <code>PortletContext</code> initialization parameter, if it exists. If it doesn&rsquo;t exist, it calls <code>getResourceAsStream()</code> using the current thread&rsquo;s context class loader passing the resource path &ldquo;<code>META-INF/services/javax.portlet.faces.Bridge</code>&rdquo;. It returns the first line of this stream excluding leading and trailing white space<sup>[<a href="TCK-Tests.html#4.7">4.7</a>]</sup>. If it can not resolve a class name, it throws a <code>PortletException</code>.</p><p>As noted <a href="Chapter-4-GenericFacesPortlet.html#4.1">4.1</a>, bridge implementations are expected to include this resource file in their implementation jar, hence the default behavior of the <code>GenericFacesPortlet</code> is to &ldquo;discover&rdquo; the appropriate bridge implementation rather then relying on a specific web application configuration settings.</p><a id="a-name427"></a><h3><a name="4.2.7"></a>4.2.7 getDefaultViewIdMap()</h3><p>Unlike direct web access, in the portlet environment target <code>viewIds</code> aren&rsquo;t directly reflected in the request <code>URL</code>. The bridge is responsible for mapping an incoming request to the correct target. In situations where the incoming request doesn&rsquo;t contain specific bridge encoded target information it must map to a default. This default is provided by the portlet in a <code>Map</code> containing an entry of defaults, one per supported <code>PortletMode</code>. During its <code>init()</code> processing, the <code>GenericFacesPortlet</code> called <code>getDefaultViewIdMap()</code> to acquire this map which it then sets at a <code>PortletContext</code> attribute <a href="Chapter-3-Bridge-Interface.html#3.2">3.2</a> for the bridge&rsquo;s use. The default (<code>GenericFacesPortlet</code>) implementation of <code>getDefaultViewIdMap()</code> reads each portlet initialization parameter prefixed named <code>javax.portlet.faces.defaultViewId.[mode]</code> where <em>mode</em> is the <code>String</code> form of a supported <code>PortletMode</code>. For each entry it adds a Map entry with mode as the key value and the initialization parameter value as the map value<sup>[<a href="TCK-Tests.html#4.8">4.8</a>]</sup>.</p><p>For the bridge to work properly one entry per supported mode must be provided in the <code>Map</code>. If in later use, the bridge can&rsquo;t find a needed entry, it throws the <code>BridgeDefaultViewNotSpecifiedException</code>.</p><a id="a-name428"></a><h3><a name="4.2.8"></a>4.2.8 getExcludedRequestAttributes()</h3><p>As a portlet lifecycle allows multiple (re)renders to occur following an action, the bridge manages an extended notion of a request scope to ensure that such rerenders produces identical results. Specifically, portlet scoped request attributes are saved/restored by the bridge across such rerenders <a href="Chapter-5-Bridge-Lifecycle-Requirements#5.1.2">5.1.2</a>. However, sometimes a portlet request scoped attribute truly must be removed when the request scope ends. The bridge uses multiple mechanisms for determining which attributes are marked for exclusion from its managed scope. The portlet can directly instruct the bridge to exclude attributes on a per portlet basis by setting a PortletContext attribute <a href="Chapter-3-Bridge-Interface.html#3.2">3.2</a>. This attribute&rsquo;s value is a <code>List</code> containing the excluded attribute names.</p><p>The <code>GenericFacesPortlet</code> sets this attribute based on the result of calling <code>getExcludedRequestAttributes()</code> in its <code>init()</code> method. The default (<code>GenericFacesPortlet</code>) implementation for <code>getExcludedRequestAttributes()</code> returns a <code>List</code> constructed by parsing the comma delimited <code>String</code> value from the corresponding portlet initialization parameter, <code>javax.portlet.faces.excludedRequestAttributes</code><sup>[<a href="TCK-Tests.html#4.9">4.9</a>]</sup>. If this initialization parameter isn&rsquo;t present <code>null</code> is returned which causes the <code>GenericFacesPortlet</code> to not set the corresponding <code>PortletContext</code> attribute<sup>[<a href="TCK-Tests.html#4.10">4.10</a>]</sup>.</p><a id="a-name429"></a><h3><a name="4.2.9"></a>4.2.9 isPreserveActionParameters()</h3><p>By default the bridge doesn&rsquo;t preserve action parameters into subsequent renders. This can be overridden on a per portlet basis by passing a value of true in the appropriate <code>PortletContext</code> attribute <a href="Chapter-3-Bridge-Interface.html#3.2">3.2</a>. To determine the setting for this attributes for this particular portlet, the <code>GenericFacesPortlet</code> calls is<code>PreserveActionParameters()</code> in its <code>init()</code> method. The default (<code>GenericFacesPortlet</code>) implementation returns the <code>boolean</code> value corresponding to the <code>String</code> value represented in the portlet initialization parameter, <code>javax.portlet.faces.preserveActionParams</code><sup>[<a href="TCK-Tests.html#4.11">4.11</a>]</sup>. If this initialization parameter doesn&rsquo;t exist, <code>false</code> is returned<sup>[<a href="TCK-Tests.html#4.12">4.12</a>]</sup>.</p><a id="a-name4210"></a><h3><a name="4.2.10"></a>4.2.10 getResponseContentType()</h3><p>This is a deprecated method that is no longer called or used by the GenericFacesPortlet. It returns the portlet container&rsquo;s indication of the preferred content type for this response<sup>[<a href="TCK-Tests.html#4.13">4.13</a>]</sup>.</p><a id="a-name4211"></a><h3><a name="4.2.11"></a>4.2.11 getResponseCharacterSetEncoding()</h3><p>This is a deprecated method that is no longer called or used by the GenericFacesPortlet. It returns null<sup>[<a href="TCK-Tests.html#4.14">4.14</a>]</sup>.</p><a id="a-name4212"></a><h3><a name="4.2.12"></a>4.2.12 getBridgeEventHandler()</h3><p>Because portlet events contain arbitrary (typed) payloads, event processing is delegated by the bridge back to the portlet application. The configured <code>BridgeEventHandler</code> is called by the bridge at the appropriate point in the lifecycle to allow the application to update the model state from information in the event. See <a href="Chapter-5-Bridge-Lifecycle-Requirements#5.2.5">5.2.5</a> for more details.</p><p>The specific <code>BridgeEventHandler</code> is conveyed to the bridge via a <code>PortletContext</code> attribute <a href="Chapter-3-Bridge-Interface.html#3.2">3.2</a>. The <code>GenericFacesPortlet</code> gets the instance it sets for this attribute by calling <code>getBridgeEventHandler</code>. If not overridden, the <code>GenericFacesPortlet</code>&rsquo;s default behavior is to read the portlet initialization parameter <code>javax.portlet.faces.bridgeEventHandler</code> and return an instance of the class that corresponds to its value<sup>[<a href="TCK-Tests.html#4.15">4.15</a>]</sup>. If this initialization parameter doesn&rsquo;t exist, null is returned<sup>[<a href="TCK-Tests.html#4.16">4.16</a>]</sup>.</p><a id="a-name4213"></a><h3><a name="4.2.13"></a>4.2.13 getBridgePublicRenderParameterHandler()</h3><p>The bridge gives the portlet an opportunity to recompute and resynchronize its models after it has pushed new public render parameter values into any corresponding mapped managed beans by calling the <code>BridgePublicRenderParameterHandler</code> conveyed to it by the portlet via a <code>PortletContext</code> attribute <a href="Chapter-3-Bridge-Interface.html#3.2">3.2</a>. See <a href="Chapter-5-Bridge-Lifecycle-Requirements#5.3">5.3</a> for more details. The <code>GenericFacesPortlet</code> gets the instance it sets for this attribute by calling <code>getBridgePublicRenderParameterHandler</code>. If not overridden, the <code>GenericFacesPortlet</code>&rsquo;s default behavior is to read the portlet initialization parameter <code>javax.portlet.faces.bridgePublicRenderParameterHandler</code> and return an instance of the class that corresponds to its value<sup>[<a href="TCK-Tests.html#4.17">4.17</a>]</sup>. If this initialization parameter doesn&rsquo;t exist, <code>null</code> is returned<sup>[<a href="TCK-Tests.html#4.18">4.18</a>]</sup>.</p><a id="a-name4214"></a><h3><a name="4.2.14"></a>4.2.14 isAutoDispatchEvents()</h3><p>In general, the bridge is designed to defer to normal portlet processing to ensure it works well in a mixed use environment. For example, action, render, and resource requests execute through the complete (<code>GenericPortlet</code>) portlet call sequence before the <code>GenericFacesPortlet</code> dispatches the request to the bridge. This allows none bridge related requests to be handled directly by the portlet. Unfortunately, the portlet event model doesn&rsquo;t lend itself as well to this delegation model. The portlet event model (via the <code>GenericPortlet</code>) encourages the use of method annotation to mark the portlet&rsquo;s event handlers. The <code>GenericPortlet</code>&rsquo;s <code>ProcessEvent()</code> method provides this behavior. Given that the model also doesn&rsquo;t support marking an event as handled, the <code>GenericFacesPortlet</code> needs fore knowledge on dispatching events to the bridge. The <code>autoDispatchEvents</code> boolean provides this information. If true, the <code>GenericFacesPortlet</code> handles all events by dispatching them directly to the bridge. If false, the <code>GenericFacesPortlet</code> doesn&rsquo;t handle any events directly, instead it delegates to the standard portlet model which is then responsible for dispatching JSF related events directly via the bridge. If not overridden, the <code>GenericFacesPortlet</code>&rsquo;s default behavior for this method is to read the portlet initialization parameter <code>javax.portlet.faces.autoDispatchEvents</code>. If it exists the value is interpreted as a boolean valued <code>String</code> (i.e. &ldquo;true&rdquo; is <code>true</code> while all other values are <code>false</code>)<sup>[<a href="TCK-Tests.html#4.19">4.19</a>]</sup>. If this initialization parameter doesn&rsquo;t exist, <code>true</code> is returned<sup>[<a href="TCK-Tests.html#4.20">4.20</a>]</sup>.</p><a id="a-name4215"></a><h3><a name="4.2.15"></a>4.2.15 getFacesBridge()</h3><p>The <code>GenericFacesPortlet</code> is designed to be self-servicing. However, there may be times, in particular when dealing with events that aren&rsquo;t auto-dispatched, in which a subclass needs to dispatch a request directly to the bridge. To support this the <code>GenericFacesPortlet</code>, via this method, returns a properly initialized and active bridge which a subclass can use to call one of the <code>doFacesRequest()</code> methods<sup>[<a href="TCK-Tests.html#4.21">4.21</a>]</sup>. The method is passed two parameters, the <code>PortletRequest</code> and <code>PortletResponse</code>. The <code>GenericFacesPortlet</code> uses these to fully prepare the bridge for a <code>doFacesRequest()</code> call.</p><a id="a-name4216"></a><h3><a name="4.2.16"></a>4.2.16 getDefaultRenderKitId()</h3><p>The <code>RenderKit</code> Faces uses commonly resolves to the default set by the application. It is therefore application wide. The default Id is resolved first by looking for a well known request parameter. If this parameter doesn&rsquo;t exist then the default Id is taken from a configuration setting in the <code>faces-config.xml</code>. Finally, if no specific default Id is configured an internal default is used. To allow a developer to differentiate the renderkits utilized by individual portlets in an application, the <code>GenericFacesPortlet</code> calls this method during <code>init()</code> to acquire the specific default renderkit Id it should configure for this portlet. If not overridden, the <code>GenericFacesPortlet</code>&rsquo;s default behavior is to return the value of the portlet initialization parameter <code>javax.portlet.faces.defaultRenderKitId</code><sup>[<a href="TCK-Tests.html#4.22">4.22</a>]</sup>. If this initialization parameter doesn&rsquo;t exist, <code>null</code> is returned<sup>[<a href="TCK-Tests.html#4.23">4.23</a>]</sup>.</p>
